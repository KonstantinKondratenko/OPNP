# Методы формирования траекторий облета зданий БПЛА для фотограмметрических исследований. Предложение улучшенной модели.
Ключевые слова: фотограмметрия, формирование траекторий, БПЛА, трехмерная модель 

## Аннотация
Беспилтоные летательные аппараты (БПЛА) используются в сфере трехмерной реконструкции объектов методами фотограмметрии. На качество получаемой модели может влиять множество факторов, одним из которых является то, как строится траектория облета здания. В данной статьей рассмотрены 5 современных методов формирования траекторий, проанализированы их преимущества и недостатки. Разработана идеи нового метода формирования траекторий, основанная на информационной отдачи, но с введением 5 оптимизаций, которые призваны усовершенствовать старый подход.  

## Введение
БПЛА используют в сфере построения трехмерных моделей методом фотограмметрии, поскольку БПЛА способен перемещаться вдоль всех трех пространственных измерений и существует возмонжость оснастить БПЛА камерой. Построение трхмерных моделей может быть полезно, например, для обследование крупных объектов, таких как здания, на предмет наличия дефектов или трещин, или же для создания трехмерных моделей уже существующих памятников. Потому, в связи с растущей популярностью использования бепилотных летательных аппратов в сфере фотограмметрических ислледований[1][2], важно понимать, какие параметры траектории полета БПЛА влияют на качество построения модели целевых объектов: высота полета, оснащение датчиками, настройки камеры, количество контрольных точек, методы позиционирования. Однако существующие решения не рассматривают количественный метод для анализа влияния конфигурации полета на точность посторения моделей[3], потому следует восполнить недостащие знания. В рамках данной статьи предлагается рассмотреть соверменные методы построения траекторий, на базе которых предложить усовершенствованную модель.

Целью данной статьи является изучение соверменных методов формирования траекторий облета зданий и предложение улучшенной модели.

Для достижения обозначенной цели были решены следующие задачи:
1. Определение критериев сравнения существующих подходов постраения траекторий.
2. Обзор существующих подходов формирования траекторий облета.
3. В ходе сравнения описать существующие методы построения траекторий облета целевого объекта с помощью БПЛА.
4. Предложение усовершенствованной модели построения траекторий облета целевого объекта с помощью БПЛА. 


## Обзор предметной области
Для того, чтобы понять какие существуют современные методы построения траекторий облета зданий БПЛА для фотограмметрических исследований, необходимо провести обзор предметной области, который будет состоять из принципов отбора аналогов, определения критериев сравнения, краткой характеристики пяти решений и формирования выводов по итогам сравнения.

## Принцип отбора аналогов
Поиск аналогов производился путем поиска статей на платформе google scholar, c помощью комбинации следующие ключевые слова:
UAV trajectory flight path planning building aerial 3d reconstruction quality models photogrammetric photogrammetry.
Так были использованы следующие запросы:
1. UAV trajectory planning for building reconstruction
2. UAV trajectory planning for building photogrammetry
3. path planning for aerial 3d reconstruction 
4. flight path and quality photogrammetric models

Таким образом производился поиск синонимичных конструкций. В рамках поставленной задачи подходят термины: UAV trajectory, flight path, path planning. Отбирались статьи, написанные не раньше 2018 года.

### Real-Time UAV Path Planning for Autonomous Urban Scene Reconstruction
В решении из статьи Real-Time UAV Path Planning for Autonomous Urban Scene Reconstruction[4] предлагается метод, в ходе которого строится траекторию и производится облет на основе карты местности (участка города). По карте находятся координаты тех здание, которые необходимо облететь. Углы здания представляются в виде узлов графа, на которых строится связанный граф. Выбор последовательности облета зданий производится с помощью алгоритма Дейкстры, движение вдоль здания - с помощью решения задачи о китайском почтальоне[5]. В результате авторы пришли к тому, что используется один облет, основанный на описанной схеме выше, что приводит к высокой детализации объекта при одном облете. 

### Flight Path Setting and Data Quality Assessments for Unmanned-Aerial-Vehicle-Based Photogrammetric Bridge Deck Documentation
В решении из статьи Flight Path Setting and Data Quality Assessments for Unmanned-Aerial-Vehicle-Based Photogrammetric Bridge Deck Documentation[6] предлагается экспериментальное исследование влияния характеристик полета на точность построения трехмерной модели. Изначально известны координаты целевого объекта (моста). В ходе проведения съемки происходит итеративный облет объекта на разной высоте (10 15 20 30 40 метров) и под разными углами (0, +-30 и +-45 градусов по отношению к нормали плоскости). В результате авторы приходят к выводу, что для построения детализированной модели необходимо, чтобы перекрытие на изображениях было 77%, а расстояние от БПЛА до целевого объекта минимальное.

### A multi-UAV cooperative route planning methodology for 3D fine-resolution building model reconstruction
В решении из статьи A multi-UAV cooperative route planning methodology for 3D fine-resolution building model reconstruction[7] предлагается метод, в котором траектория строится на основе вида объекта сверху и выделении контуров объекта. Траектория состоит из трех этапов - облет объекта сверху по площади, облет по периметру сверху, облет по периметру с уменьшением высоте при облете (после полного облета периметра снижается высота и процесс повторяется).  В результате авторы статьи приходят к выводу, что предложенная ими модель подходит для фотограмметрических исследований.

### Sampling-Based Path Planning for High-Quality Aerial 3D Reconstruction of Urban Scenes
В решении из статьи Sampling-Based Path Planning for High-Quality Aerial 3D Reconstruction of Urban Scenes[8] предлагается метод, основанный на первичном облете и уточняющем повторном облете. Производится первичный облет объекта для построения грубой модели объекта. Запускается повторный облет, который анализирует результат первого облета -- для каждой точки первичного облета рассматривается набор кандидатов на улучшения точки обзора в окрестности этой точки. Кандидаты оцениваются по следующим параметрам: близость к области худшего построения первичной модели, евклидово расстояние от точки первичного облета, угол между нормалью к плоскости целелого объекта и углом обзора. Для каждой точки первичного облета жадным образом происходит выбор наиболее удачного кандидата по описанным выше параметрам. В результате авторы приходят к тому, что второй облет, уточняющий первичный, приодит к повышению детализации результирующей трехмерной модели.

### Informed Sampling Exploration Path Planner for 3D Reconstruction of Large Scenes
В решении из статьи Informed Sampling Exploration Path Planner for 3D Reconstruction of Large Scenes[9] предлагается метод, не требующий априорных данных о целевом объекте (ни первичного облета, ни фото сверху). При сборе данных анализируются границы поверхности целевого объекта, границы представляют собой области, где известная модель резко обрывается, указывая на наличие неисследованных участков. Для каждой точки на границах поверхности алгоритм оценивает потенциальную информационную отдачу, которую можно получить, произведя съемку в этой точке. Точки ранжируются по удаленности от текущего положения и объема информационной отдачи. Переход между точками производится на базе алгоритма A. Процесс итеративно повторяется. Доступен исходный код решения[10]. В результате авторы приходят к тому, что их метод построения траекторий предоставляет необходимый объем фотографической информации для построения трехмерной модели целевого объекта.

## Критерии сравнения аналогов
В ходе рассмотрения аналогов выявлено, что все методы базируются либо на одном облете, либо на серии итеративных облетов. Это важный фактор, который влияет на то, сколько времени будет производиться сбор данных, и на требования к БПЛА (к запасу его хода). Этот фактор необходимо учитывать, однако его не получится добавить в таблицу сравнения аналогов по условию задания (критерий должен быть небинарным).

### Входные данные

Необходимые входные данные для построения траектории. 

### Метод построения ключевых точек траектории

Что лежит в основе выбора позиции для съемки объекта. В рассматриваемых статьях это может быть заранее принятый паттерн (например облет по периметру или по прямой), определение ключевых точек с помощь алгоритма дейкстры, жадный выбор точки, основанный на оценке, эвристическая оценка потенциальной информационной отдачи.

### Метод движения между ключевыми точками

Каким способом БПЛА перемещается между ключевыми точками

## Таблица сравнения аналогов
| критерий\статья                            | 1                                                                | 2                                                   | 3                            | 4                                                                    | 5                                                                        |
|--------------------------------------------|------------------------------------------------------------------|-----------------------------------------------------|------------------------------|----------------------------------------------------------------------|--------------------------------------------------------------------------|
| Входные данные                             | Фотография целевого объекта сверху                                                       | Координаты объекта                                  | Фотография целевого объекта сверху                  | Первичный облет целового объекта сверху                                                     | Отсутствуют                                                              |
| Метод построения ключевых точек траектории | алгоритм Дейкстры                                                | Предварительное определение прямолинейно траектории | На основе трех подтраекторий | жадный выбор кандидата в окрестности точки первичного облета | выбор кандидатов по потенциальному значению информационной отдачи |
| Метод движения между ключевыми точками     | Движением по точкам, полученным из задачи о китайском почтальоне | прямолинейное движение                              | прямолинейное движение       | прямолинейное движение                                               | Движение по точкам в порядке обхода A                                   |

## Выводы по итогам сравнения
В результате сравнения аналогов можно сделать вывод, что все аналоги  (за исключением аналога 3) используют не конкретный паттерн траектории, а точечную съемку в ключевых точках. Построение результирующей траектории на основании грубой имеет свои недостатки в виде увеличения времени работы (поскольку нужно 2 облета минимум) и зависимость ключевых точек результирующей траектории от точек первичного облета, однако отсутствует описание методов первичного облета, что не гарантирует корректность выбора первичного облета. Метод построения ключевых точек на основе информационной отдачи (аналог 5) представляет наиболее адаптивное решение, не зависящее от входных параметров и качества построения первичной модели, однако имеет концептуальные недостатки, такие как возможность попадания в локальном оптимуме, отсутствие привязки к априорным данным о целевом объекте.

## Выбор метода решения
В ходе анализа найденных аналогов, выявления их особенностей и недостатков, принято решение использовать композиционный подход на основе анализа информационной отдачи исследования целевого объекта, но с оптимизациями, использующими априорные знания о целевых объектах, и предусматривающими защиту от таких проблем жадного выбора ключевых точек, как попадание в локальный оптимум. Выбронный метод можно рассмотреть на следущем примере: 
В качестве априорных знаний о целевом объекте возьмем координаты целевого объекта, чтобы ограничить область исследования. В ограниченной области применяется метод, описанный в аналоге 5, но со следующими оптимизациями:
1. Область исследования ограничена координатами объекта.
2. Сохранение пути для возможности для возможности анализа пройденных шагов и выявления попадания в локальный оптимум (если последние n шагов повторяются с погрешностью p [которую нужно будет экспериментально установить], то на все точки в области, в которой локализются эти n шагов, накладывается отрицательный коэффициент, что приведет к исследованию других областей).
3. Введение порога на объем информационной отдачи, при котором все кандидаты со значением информационной отдачи меньшем этого порога не рассматриваются.
4. Введение метода backtracking[11], для возврата к предыдущему состоянию (точке траектории), если в текущей точке все кандидаты имеют информационную отдачу ниже порога, установленном в п.3.
5. Остановка алгоритма если все кандидаты всех точек траектории имеют информационную отдачу ниже порога, установленном в п.3.

## Будущие исследования
### Экспериментальные исследования выбранного решения
1. Провести эксперименты с использованием симулятора gym-pybullet-drones для проверки предложенной модели.
2. Экспериментальный подбор коэффициента погрешности p, количества шагов n и порога объема информационной отдачи.
   
### Применение возможных оптимизаций выбранного методы
1. Выявление зависимости между свойствами целевого объекта и применяемых коэффициентов и порогов.
2. Введение динамической системы расчетов коэффициентов и порогов в зависимости от свойств целевого объекта.
3. Рассмотрение возможности использования оптимизаций жадного выбора и backtracking, например, с помощью алгоритма имитация отжига[12].

### Масштабирование метода
1. Рассмотрение возможности примененения метода не только на одном целевом объекте, но и на архитектурном ансамбле.
2. Рассмотрение возможности реализации метода с помощью нескольких БПЛА.


## Заключение
В данной статья сформированы критерии сравнения существующих подходов постраения траекторий, произведен обзор пяти аналогов[4][6-9], описаны рассмотренные методы формирования траекторий, а также предложена усовершенствованная модель построения трехмерной модели целевого объекта на основе анализа информационной отдачи исследования целевого объекта, но с пятью ключевыми оптимизациями:
1. Ограничение области исследования
2. Сохранение пути
3. Введение порога на объем информационной отдачи
4. Введение метода backtracking
5. Определение достижимых условий завершения работы алгоритма.
Рассмотрены направления дальнейших исследований и возможные усовершенствования предложенного метода.


## Список использованных источников

1. Nex F., Remondino F., UAV for 3D mapping  applications: A review. Appl. Geomat. 2014. URL: https://doi.org/10.1007/s12518-013-0120-x
2. Shuhang Zhang, Chun Liu, Norbert Haala, Guided by model quality: UAV path planning for complete and precise 3D reconstruction of complex buildings //International Journal of Applied Earth Observation and Geoinformation, Volume 127. 2024. URL: https://www.sciencedirect.com/science/article/pii/S1569843224000219
3. Liu, Y.; Han, K.; Rasdorf, W. Assessment and Prediction of Impact of Flight Configuration Factors on UAS-Based Photogrammetric Survey Accuracy. Remote Sens. 2022, 14, 4119. URL: https://doi.org/10.3390/rs14164119
4. Q. Kuang, J. Wu, J. Pan and B. Zhou, "Real-Time UAV Path Planning for Autonomous Urban Scene Reconstruction," 2020 IEEE International Conference on Robotics and Automation (ICRA), Paris, France, 2020, pp. 1156-1162, doi: 10.1109/ICRA40945.2020.9196558. URL: https://ieeexplore.ieee.org/abstract/document/9196558
5. Sökmen, Özlem & Emeç, Şeyma & Yilmaz, Mustafa & Akkaya, Gökay. (2019). An Overview of Chinese Postman Problem. URL: https://www.researchgate.net/publication/337026526_An_Overview_of_Chinese_Postman_Problem
6. Chen, S.; Zeng, X.; Laefer, D.F.; Truong-Hong, L.; Mangina, E. Flight Path Setting and Data Quality Assessments for Unmanned-Aerial-Vehicle-Based Photogrammetric Bridge Deck Documentation. Sensors 2023, 23, 7159. URL: https://www.mdpi.com/1424-8220/23/16/7159
7. Xiaocui Zheng, Fei Wang, Zhanghua Li, A multi-UAV cooperative route planning methodology for 3D fine-resolution building model reconstruction, ISPRS Journal of Photogrammetry and Remote Sensing, Volume 146, 2018. URL: https://www.sciencedirect.com/science/article/abs/pii/S0924271618303009?casa_token=Mfp5ZWq9VyAAAAAA:hRvYATwzphicXxVzRqacYFtmlaTsiJph8OAEvHhvTMQsu1WZWhYGUwKqbkPazJt8627YQ09UNw
8. Yan, F.; Xia, E.; Li, Z.; Zhou, Z. Sampling-Based Path Planning for High-Quality Aerial 3D Reconstruction of Urban Scenes. Remote Sens. 2021 URL: https://www.mdpi.com/2072-4292/13/5/989
9. Y. Kompis, L. Bartolomei, R. Mascaro, L. Teixeira and M. Chli, "Informed Sampling Exploration Path Planner for 3D Reconstruction of Large Scenes," in IEEE Robotics and Automation Letters, vol. 6, no. 4, pp. 7893-7900, Oct. 2021. URL: https://ieeexplore.ieee.org/document/9507252
10. Открытый код для статьи Informed Sampling Exploration Path Planner for 3D Reconstruction of Large Scenes  URL:  https://github.com/ethz-asl/mav_active_3d_planning
11. Grzegorz Kondrak, Peter van Beek, A theoretical evaluation of selected backtracking algorithms, Artificial Intelligence, Volume 89, Issues 1–2, 1997, Pages 365-387, URL: https://doi.org/10.1016/S0004-3702(96)00027-6
12. S. Kirkpatrick et al. ,Optimization by Simulated Annealing.Science220,671-680(1983). URL: https://www.science.org/doi/10.1126/science.220.4598.671





